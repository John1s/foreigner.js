/*! foreigner.js - v0.3.0 - 2015-03-09
 * http://github.com/mirego/foreigner.js
 *
 * Copyright (c) 2013-2015 Mirego <http://mirego.com>;
 * Licensed under the New BSD license */

!function(a,b){"function"==typeof define&&define.amd?define("foreigner",[],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.foreigner=b()}(this,function(){var foreigner,a="\\s*",b="[a-z0-9_\\$]+",c="\\{"+a+"("+b+")"+a+","+a+"(select|plural)"+a+","+a+"((?:\\w+"+a+"\\{[^\\}]+\\}"+a+")+)\\}",d="\\{"+a+"("+b+")"+a+"\\}",e=new RegExp("(?:"+c+")|(?:"+d+")","gi"),f=new RegExp("(\\w+)"+a+"\\{([^\\}]+)\\}","gi"),g={0:"zero",1:"one",2:"two"},h=function(a,b){var c=a.indexOf(".")>=0?i(a,b):j(a,b);return c?k(c,b):null},i=function(a,b){for(var c=a.split("."),d=foreigner.translations[b],e=0;e<c.length&&d;){var f=c[e];d="object"==typeof d&&f in d?d[f]:null,e++}return d},j=function(a,b){return foreigner.translations[b][a]},k=function(a,b){for(;"string"==typeof a&&"!"===a.charAt(0);)a=h(a.slice(1),b);return a},l=function(a){for(var b,c=[];null!==(b=e.exec(a));){var d={toReplace:b[0],action:"",key:"",choices:{}};if(b[4])d.action="interpolation",d.key=b[4];else{d.key=b[1],d.action=b[2];for(var g;null!==(g=f.exec(b[3]));)d.choices[g[1]]=g[2]}c.push(d)}return f.lastIndex=0,e.lastIndex=0,c},m=function(a,b,c){for(var d=0,e=b.length;e>d;d++){var f,h=b[d],i=null==c[h.key]?"":c[h.key];switch(h.action){case"interpolation":f=i;break;case"plural":f=h.choices[i]||h.choices[g[i]]||h.choices.other,f=f.replace("#",i);break;case"select":f=h.choices[i]||h.choices.other}a=a.replace(h.toReplace,f)}return a};return foreigner={locale:"",translations:{},t:function(a,b){var c=foreigner.locale;if(2===arguments.length&&"string"==typeof b?c=b:3===arguments.length&&(c=arguments[2]),!c)throw new Error("[foreigner] You tried to lookup a translation without setting a locale.");var d=h(a,c);if(!d)return null;if("object"!=typeof b)return d;var e=l(d);return m(d,e,b)}}});