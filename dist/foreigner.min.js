 * http://github.com/mirego/foreigner.js
 *
 * Copyright (c) 2013-2016 Mirego <http://mirego.com>;
 * Licensed under the New BSD license */

!function(a,b){"function"==typeof define&&define.amd?define("foreigner",[],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.foreigner=b()}(this,function(){return function(a,b){"function"==typeof define&&define.amd?define("foreigner",[],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.foreigner=b()}(this,function(){var foreigner,a="\\s*",b="[a-z0-9_\\$]+",c="\\{"+a+"("+b+")"+a+","+a+"(select|plural)"+a+","+a+"((?:\\w+"+a+"\\{[^\\}]+\\}"+a+")+)\\}",d="\\{"+a+"("+b+")"+a+"\\}",e="\\{\\s*([a-z0-9_\\$]+)\\s*:([^\\}]+)\\s*\\}",f=new RegExp("(?:"+c+")|(?:"+d+")|(?:"+e+")","gi"),g=new RegExp("(\\w+)"+a+"\\{([^\\}]+)\\}","gi"),h={0:"zero",1:"one",2:"two"},i=function(a,b){var c=a.indexOf(".")>=0?j(a,b):k(a,b);return c?l(c,b):null},j=function(a,b){for(var c=a.split("."),d=foreigner.translations[b],e=0;e<c.length&&d;){var f=c[e];d="object"==typeof d&&f in d?d[f]:null,e++}return d},k=function(a,b){return foreigner.translations[b][a]},l=function(a,b){for(;"string"==typeof a&&"!"===a.charAt(0);)a=i(a.slice(1),b);return a},m=function(a){for(var b,c=[];null!==(b=f.exec(a));){var d={toReplace:b[0],action:"",key:"",choices:{}};if(b[6])d.action="format",d.key=b[5],d.format=b[6];else if(b[4])d.action="interpolation",d.key=b[4];else{d.key=b[1],d.action=b[2];for(var e;null!==(e=g.exec(b[3]));)d.choices[e[1]]=e[2]}c.push(d)}return g.lastIndex=0,f.lastIndex=0,c},n=function(a,b,c,d){for(var e=0,f=b.length;f>e;e++){var g,i=b[e],j=null==c[i.key]?"":c[i.key];switch(i.action){case"interpolation":g=j;break;case"format":g=null==d?j:d.format(j,i.format);break;case"plural":g=i.choices[j]||i.choices[h[j]]||i.choices.other,g=g.replace("#",j);break;case"select":g=i.choices[j]||i.choices.other}a=a.replace(i.toReplace,g)}return a};return foreigner={locale:"",translations:{},t:function(a,b){var c=foreigner.locale;if(2===arguments.length&&"string"==typeof b?c=b:3===arguments.length&&(c=arguments[2]),!c)throw new Error("[foreigner] You tried to lookup a translation without setting a locale.");var d=i(a,c);if(!d)return null;if("object"!=typeof b)return d;var e=m(d),f=b.formatter;return n(d,e,b,f)}}}),foreigner});